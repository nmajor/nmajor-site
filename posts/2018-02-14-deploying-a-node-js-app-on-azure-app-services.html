<!DOCTYPE html><html lang="en" class="h-full antialiased"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=16&amp;q=75 16w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=32&amp;q=75 32w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=48&amp;q=75 48w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=64&amp;q=75 64w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=96&amp;q=75 96w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=128&amp;q=75 128w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=256&amp;q=75 256w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=384&amp;q=75 384w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=640&amp;q=75 640w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=750&amp;q=75 750w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=828&amp;q=75 828w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=3840&amp;q=75 3840w" imageSizes="2.25rem" fetchPriority="high"/><link rel="stylesheet" href="/_next/static/css/9d8f288a99c54fb3.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-113544170b8b14d7.js" crossorigin=""/><script src="/_next/static/chunks/de8a8aed-ff24f23ca546a20c.js" async="" crossorigin=""></script><script src="/_next/static/chunks/362-edde6a9467fb7f3f.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-dca2b37e6b098eb8.js" async="" crossorigin=""></script><script src="/_next/static/chunks/736-93d26bf9f492bada.js" async=""></script><script src="/_next/static/chunks/545-972397648c423446.js" async=""></script><script src="/_next/static/chunks/871-e93f475163439fcd.js" async=""></script><script src="/_next/static/chunks/app/layout-58152a9375fe786b.js" async=""></script><script src="/_next/static/chunks/app/posts/page-6d06c0c42f2ef9eb.js" async=""></script><title>Deploying Node.js on Azure App Services - Spencer Sharp</title><meta name="description" content="I’m Spencer, a software designer and entrepreneur based in New York City. I’m the founder and CEO of Planetaria, where we develop technologies that empower regular people to explore space on their own terms."/><link rel="alternate" type="application/rss+xml" href="undefined/feed.xml"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="flex h-full"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="flex w-full"><div class="relative flex w-full flex-col"><header class="pointer-events-none relative z-50 flex flex-none flex-col" style="height:var(--header-height);margin-bottom:var(--header-mb)"><div class="top-0 z-10 h-16 pt-6" style="position:var(--header-position)"><div class="sm:px-8 top-[var(--header-top,theme(spacing.6))] w-full" style="position:var(--header-inner-position)"><div class="mx-auto w-full max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="relative flex gap-4"><div class="flex flex-1"><div class="h-10 w-10 rounded-full bg-white/90 p-0.5 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90 dark:ring-white/10"><a aria-label="Home" class="pointer-events-auto" href="/"><img alt="" fetchPriority="high" width="1000" height="1000" decoding="async" data-nimg="1" class="rounded-full bg-zinc-100 object-cover dark:bg-zinc-800 h-9 w-9" style="color:transparent" sizes="2.25rem" srcSet="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=16&amp;q=75 16w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=32&amp;q=75 32w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=48&amp;q=75 48w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=64&amp;q=75 64w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=96&amp;q=75 96w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=128&amp;q=75 128w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=256&amp;q=75 256w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=384&amp;q=75 384w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=640&amp;q=75 640w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=750&amp;q=75 750w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=828&amp;q=75 828w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=3840&amp;q=75 3840w" src="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=3840&amp;q=75"/></a></div></div><div class="flex flex-1 justify-end md:justify-center"><nav class="pointer-events-auto hidden md:block"><ul class="flex rounded-full bg-white/90 px-3 text-sm font-medium text-zinc-800 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90 dark:text-zinc-200 dark:ring-white/10"><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/about">About</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/posts">Blog</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/projects">Projects</a></li></ul></nav></div><div class="flex justify-end md:flex-1"><div class="pointer-events-auto"><button class="inline-flex items-center justify-center text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-md h-8 w-8 px-0" type="button" id="radix-:R75la:" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 3v1"></path><path d="M12 20v1"></path><path d="M3 12h1"></path><path d="M20 12h1"></path><path d="m18.364 5.636-.707.707"></path><path d="m6.343 17.657-.707.707"></path><path d="m5.636 5.636.707.707"></path><path d="m17.657 17.657.707.707"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div></div></div></div></div></div></div></div></header><main class="flex-auto"><div class="sm:px-8 post mt-16 lg:mt-32"><div class="mx-auto w-full max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="xl:relative"><div class="mx-auto max-w-2xl"><article><header class="flex flex-col"><h1 class="text-4xl font-bold font-bold tracking-tight sm:text-5xl">Deploying Node.js on Azure App Services</h1><div class="flex gap-3 pt-1"><time dateTime="2018-02-14" class="text-muted-foreground order-first flex items-center pr-2 text-base"><span class="h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span><span class="ml-3">February 14, 2018</span></time><span class="text-muted-foreground">-</span><span class="text-muted-foreground/80">node</span><span class="text-muted-foreground/80">azure</span><span class="text-muted-foreground/80">production</span></div><div class="text-accent-foreground pt-3 text-sm italic">~<!-- -->4 min read</div></header><div class="mt-8 prose dark:prose-invert" data-mdx-content="true"><div><p>In this post I'm going to go over how to deploy a Node.js app to Azure App Services and also mention some of the things I learned from working with Azure.</p>
<h1 id="your-azure-account"><a aria-hidden="true" tabindex="-1" href="#your-azure-account"><a href="#your-azure-account" style="margin-right: 10px">#</a></a>Your Azure Account</h1>
<h3 id="azure-account"><a aria-hidden="true" tabindex="-1" href="#azure-account"><a href="#azure-account" style="margin-right: 10px">#</a></a>Azure account</h3>
<p>First of all, you need to make sure you have an Azure account. If you don't have one you can sign up for Azure <a href="https://azure.microsoft.com/free/" title="Azure Signup">here</a>.</p>
<h3 id="azure-subscription"><a aria-hidden="true" tabindex="-1" href="#azure-subscription"><a href="#azure-subscription" style="margin-right: 10px">#</a></a>Azure Subscription</h3>
<p>Azure requires you to have something called a subscription before you can start using Azure services. This subscription is basically a billing program.</p>
<p>Double check that you have a subscription by going to this page in your Azure portal:</p>
<p><a href="https://portal.azure.com/#blade/Microsoft_Azure_Billing/SubscriptionsBlade" title="https://portal.azure.com/#blade/Microsoft_Azure_Billing/SubscriptionsBlade">https://portal.azure.com/#blade/Microsoft_Azure_Billing/SubscriptionsBlade</a></p>
<p>If you don't see a subscription listed, then add one.</p>
<p>If you have just signed up you'll notice that one of the subscription options is "Free Trial" so you can use that and then later change to a "Pay as You Go" option later if you run out of free resources.</p>
<h3 id="azure-command-line-tool"><a aria-hidden="true" tabindex="-1" href="#azure-command-line-tool"><a href="#azure-command-line-tool" style="margin-right: 10px">#</a></a>Azure Command Line Tool</h3>
<p>We are going to be doing this entire setup using the Azure command line tool.</p>
<p>You can download and install the command line tool by following the [instructions here](<a href="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest" title="https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest">https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest</a>)</p>
<p>Once you have that installed and working, we are ready to get started deploying the app.</p>
<h3 id="create-a-deployment-user"><a aria-hidden="true" tabindex="-1" href="#create-a-deployment-user"><a href="#create-a-deployment-user" style="margin-right: 10px">#</a></a>Create a deployment user</h3>
<p>This deployment user will be used when deploying your code. Basically we are going to configure the app to be deployed with git so when you do a <code>git push azure master</code> it will ask you for the password that you set here.</p>
<p>Run this in the command line:</p>
<pre><code>az webapp deployment user set --user-name &#x3C;username> --password &#x3C;password>
</code></pre>
<h3 id="create-a-resource-group"><a aria-hidden="true" tabindex="-1" href="#create-a-resource-group"><a href="#create-a-resource-group" style="margin-right: 10px">#</a></a>Create a resource group</h3>
<p>Resource groups are basically just a way to group together resources so you can easily monitor them together, track costs, and stuff.</p>
<p>Replace <code>&#x3C;my-resource-group></code> with a resource group name you want.</p>
<pre><code>az group create --name &#x3C;my-resource-group> --location westeurope
</code></pre>
<h3 id="create-a-service-plan"><a aria-hidden="true" tabindex="-1" href="#create-a-service-plan"><a href="#create-a-service-plan" style="margin-right: 10px">#</a></a>Create a service plan</h3>
<p>This is where you will set the how many resources your app will use.</p>
<p>The command below will create a <code>FREE</code> tier app that has about 1 GB of RAM. You could also set the <code>--sku</code> tag to <code>BASIC</code> or <code>SHARED</code> or any of the other [service plans here](<a href="https://azure.microsoft.com/en-us/pricing/details/app-service/" title="https://azure.microsoft.com/en-us/pricing/details/app-service/">https://azure.microsoft.com/en-us/pricing/details/app-service/</a>).</p>
<p>Also be sure to set your <code>&#x3C;my-app-service-plan></code> and also make sure you set <code>&#x3C;my-resource-group></code> to your resource group name from earlier.</p>
<pre><code>az appservice plan create --name &#x3C;my-app-service-plan> --resource-group &#x3C;my-resource-group> --sku FREE
</code></pre>
<h3 id="create-the-app"><a aria-hidden="true" tabindex="-1" href="#create-the-app"><a href="#create-the-app" style="margin-right: 10px">#</a></a>Create the app</h3>
<p>Now we actually create the app, you have to give your app an <code>&#x3C;app-name></code> and then make sure you paste in all the other options from things you've created previously.</p>
<pre><code>az webapp create --name &#x3C;app-name> --resource-group &#x3C;my-resource-group> --plan &#x3C;my-app-service-plan>
</code></pre>
<h3 id="configure-git-for-deployment"><a aria-hidden="true" tabindex="-1" href="#configure-git-for-deployment"><a href="#configure-git-for-deployment" style="margin-right: 10px">#</a></a>Configure git for deployment</h3>
<p>This command sill set up you app to be deployed using git. The response you get from this command will be a git url you can use as the git remote to deploy.</p>
<pre><code>az webapp deployment source config-local-git --name &#x3C;app-name> --resource-group &#x3C;my-resource-group> --query url --output tsv
</code></pre>
<h3 id="configure-startup-script"><a aria-hidden="true" tabindex="-1" href="#configure-startup-script"><a href="#configure-startup-script" style="margin-right: 10px">#</a></a>Configure startup script</h3>
<p>If you are coding in ES6 you probably have a build step. For that you may want to set up a custom deploy script. [Here is the documentation for how to do that](<a href="https://github.com/projectkudu/kudu/wiki/Custom-Deployment-Script" title="https://github.com/projectkudu/kudu/wiki/Custom-Deployment-Script">https://github.com/projectkudu/kudu/wiki/Custom-Deployment-Script</a>).</p>
<p>However I've noticed a bug here. Sometimes the order of commands in the deploy script appears to not be honored. According to [this github issue](<a href="https://github.com/projectkudu/kudu/issues/2699" title="https://github.com/projectkudu/kudu/issues/2699">https://github.com/projectkudu/kudu/issues/2699</a>), it may be related to the Always On setting in your app. But regardless the app tries to start up before the my deploy script is finished, which means it tries to run code that isnt built from webpacker yet.</p>
<p>So, in an effort to find a quick fix I just committed my built files which sucks. I'm still trying to figure out a better workaround here because there hasn't been a lot of movement on that particular github issue.</p></div></div></article></div></div></div></div></div></div></main><footer class="mt-32 flex-none"><div class="sm:px-8"><div class="mx-auto w-full max-w-7xl lg:px-8"><div class="pb-16 pt-10"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="flex flex-col items-center justify-between gap-6 sm:flex-row"><div class="flex flex-wrap justify-center gap-x-6 gap-y-1 text-sm font-medium text-zinc-800 dark:text-zinc-200"><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/about">About</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/projects">Projects</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/speaking">Speaking</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/uses">Uses</a></div><p class="text-sm text-zinc-400 dark:text-zinc-500">© <!-- -->2023<!-- --> Spencer Sharp. All rights reserved.</p></div></div></div></div></div></div></footer></div></div><script src="/_next/static/chunks/webpack-113544170b8b14d7.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/9d8f288a99c54fb3.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[7483,[],\"\"]\n5:I[655,[],\"\"]\n6:I[2286,[\"736\",\"static/chunks/736-93d26bf9f492bada.js\",\"545\",\"static/chunks/545-972397648c423446.js\",\"871\",\"static/chunks/871-e93f475163439fcd.js\",\"185\",\"static/chunks/app/layout-58152a9375fe786b.js\"],\"ThemeProvider\"]\n7:I[7019,[\"736\",\"static/chunks/736-93d26bf9f492bada.js\",\"545\",\"static/chunks/545-972397648c423446.js\",\"871\",\"static/chunks/871-e93f475163439fcd.js\",\"185\",\"static/chunks/app/layout-58152a9375fe786b.js\"],\"Header\"]\n8:I[3849,[],\"\"]\n9:I[8656,[],\"\"]\na:I[4736,[\"736\",\"s"])</script><script>self.__next_f.push([1,"tatic/chunks/736-93d26bf9f492bada.js\",\"991\",\"static/chunks/app/posts/page-6d06c0c42f2ef9eb.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/9d8f288a99c54fb3.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"ukvsT-xGIrbijjiNPJuDN\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/2018-02-14-deploying-a-node-js-app-on-azure-app-services\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"2018-02-14-deploying-a-node-js-app-on-azure-app-services\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"2018-02-14-deploying-a-node-js-app-on-azure-app-services\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L4\"],\"globalErrorComponent\":\"$5\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"h-full antialiased\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"flex h-full\",\"children\":[\"$\",\"$L6\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"div\",null,{\"className\":\"flex w-full\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative flex w-full flex-col\",\"children\":[[\"$\",\"$L7\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-auto\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"sm:px-8 flex h-full items-center pt-16 sm:pt-32\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative px-4 sm:px-8 lg:px-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl lg:max-w-5xl\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-base font-semibold text-zinc-400 dark:text-zinc-500\",\"children\":\"404\"}],[\"$\",\"h1\",null,{\"className\":\"mt-4 text-4xl font-bold tracking-tight text-zinc-800 dark:text-zinc-100 sm:text-5xl\",\"children\":\"Page not found\"}],[\"$\",\"p\",null,{\"className\":\"mt-4 text-base text-zinc-600 dark:text-zinc-400\",\"children\":\"Sorry, we couldn’t find the page you’re looking for.\"}],[\"$\",\"$La\",null,{\"href\":\"/\",\"children\":[\"$\",\"button\",null,{\"className\":\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 mt-4\",\"children\":\"Go back home\"}]}]]}]}]}]}]}],\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"slug\",\"2018-02-14-deploying-a-node-js-app-on-azure-app-services\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Lb\",\"$Lc\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"2018-02-14-deploying-a-node-js-app-on-azure-app-services\\\"}\"},\"styles\":null}],\"segment\":[\"slug\",\"2018-02-14-deploying-a-node-js-app-on-azure-app-services\",\"d\"]},\"styles\":null}],\"segment\":\"posts\"},\"styles\":null}]}],[\"$\",\"footer\",null,{\"className\":\"mt-32 flex-none\",\"children\":[\"$\",\"div\",null,{\"className\":\"sm:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"pb-16 pt-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative px-4 sm:px-8 lg:px-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl lg:max-w-5xl\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-between gap-6 sm:flex-row\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap justify-center gap-x-6 gap-y-1 text-sm font-medium text-zinc-800 dark:text-zinc-200\",\"children\":[[\"$\",\"$La\",null,{\"href\":\"/about\",\"className\":\"transition hover:text-teal-500 dark:hover:text-teal-400\",\"children\":\"About\"}],[\"$\",\"$La\",null,{\"href\":\"/projects\",\"className\":\"transition hover:text-teal-500 dark:hover:text-teal-400\",\"children\":\"Projects\"}],[\"$\",\"$La\",null,{\"href\":\"/speaking\",\"className\":\"transition hover:text-teal-500 dark:hover:text-teal-400\",\"children\":\"Speaking\"}],[\"$\",\"$La\",null,{\"href\":\"/uses\",\"className\":\"transition hover:text-teal-500 dark:hover:text-teal-400\",\"children\":\"Uses\"}]]}],[\"$\",\"p\",null,{\"className\":\"text-sm text-zinc-400 dark:text-zinc-500\",\"children\":[\"© \",2023,\" Spencer Sharp. All rights reserved.\"]}]]}]}]}]}]}]}]}]]}]}]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"d:T1b14,"])</script><script>self.__next_f.push([1,"\u003cp\u003eIn this post I'm going to go over how to deploy a Node.js app to Azure App Services and also mention some of the things I learned from working with Azure.\u003c/p\u003e\n\u003ch1 id=\"your-azure-account\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#your-azure-account\"\u003e\u003ca href=\"#your-azure-account\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eYour Azure Account\u003c/h1\u003e\n\u003ch3 id=\"azure-account\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#azure-account\"\u003e\u003ca href=\"#azure-account\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eAzure account\u003c/h3\u003e\n\u003cp\u003eFirst of all, you need to make sure you have an Azure account. If you don't have one you can sign up for Azure \u003ca href=\"https://azure.microsoft.com/free/\" title=\"Azure Signup\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"azure-subscription\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#azure-subscription\"\u003e\u003ca href=\"#azure-subscription\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eAzure Subscription\u003c/h3\u003e\n\u003cp\u003eAzure requires you to have something called a subscription before you can start using Azure services. This subscription is basically a billing program.\u003c/p\u003e\n\u003cp\u003eDouble check that you have a subscription by going to this page in your Azure portal:\u003c/p\u003e\n\u003cp\u003e\u003ca href=\"https://portal.azure.com/#blade/Microsoft_Azure_Billing/SubscriptionsBlade\" title=\"https://portal.azure.com/#blade/Microsoft_Azure_Billing/SubscriptionsBlade\"\u003ehttps://portal.azure.com/#blade/Microsoft_Azure_Billing/SubscriptionsBlade\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eIf you don't see a subscription listed, then add one.\u003c/p\u003e\n\u003cp\u003eIf you have just signed up you'll notice that one of the subscription options is \"Free Trial\" so you can use that and then later change to a \"Pay as You Go\" option later if you run out of free resources.\u003c/p\u003e\n\u003ch3 id=\"azure-command-line-tool\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#azure-command-line-tool\"\u003e\u003ca href=\"#azure-command-line-tool\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eAzure Command Line Tool\u003c/h3\u003e\n\u003cp\u003eWe are going to be doing this entire setup using the Azure command line tool.\u003c/p\u003e\n\u003cp\u003eYou can download and install the command line tool by following the [instructions here](\u003ca href=\"https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest\" title=\"https://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest\"\u003ehttps://docs.microsoft.com/en-us/cli/azure/install-azure-cli?view=azure-cli-latest\u003c/a\u003e)\u003c/p\u003e\n\u003cp\u003eOnce you have that installed and working, we are ready to get started deploying the app.\u003c/p\u003e\n\u003ch3 id=\"create-a-deployment-user\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#create-a-deployment-user\"\u003e\u003ca href=\"#create-a-deployment-user\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eCreate a deployment user\u003c/h3\u003e\n\u003cp\u003eThis deployment user will be used when deploying your code. Basically we are going to configure the app to be deployed with git so when you do a \u003ccode\u003egit push azure master\u003c/code\u003e it will ask you for the password that you set here.\u003c/p\u003e\n\u003cp\u003eRun this in the command line:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eaz webapp deployment user set --user-name \u0026#x3C;username\u003e --password \u0026#x3C;password\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"create-a-resource-group\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#create-a-resource-group\"\u003e\u003ca href=\"#create-a-resource-group\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eCreate a resource group\u003c/h3\u003e\n\u003cp\u003eResource groups are basically just a way to group together resources so you can easily monitor them together, track costs, and stuff.\u003c/p\u003e\n\u003cp\u003eReplace \u003ccode\u003e\u0026#x3C;my-resource-group\u003e\u003c/code\u003e with a resource group name you want.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eaz group create --name \u0026#x3C;my-resource-group\u003e --location westeurope\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"create-a-service-plan\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#create-a-service-plan\"\u003e\u003ca href=\"#create-a-service-plan\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eCreate a service plan\u003c/h3\u003e\n\u003cp\u003eThis is where you will set the how many resources your app will use.\u003c/p\u003e\n\u003cp\u003eThe command below will create a \u003ccode\u003eFREE\u003c/code\u003e tier app that has about 1 GB of RAM. You could also set the \u003ccode\u003e--sku\u003c/code\u003e tag to \u003ccode\u003eBASIC\u003c/code\u003e or \u003ccode\u003eSHARED\u003c/code\u003e or any of the other [service plans here](\u003ca href=\"https://azure.microsoft.com/en-us/pricing/details/app-service/\" title=\"https://azure.microsoft.com/en-us/pricing/details/app-service/\"\u003ehttps://azure.microsoft.com/en-us/pricing/details/app-service/\u003c/a\u003e).\u003c/p\u003e\n\u003cp\u003eAlso be sure to set your \u003ccode\u003e\u0026#x3C;my-app-service-plan\u003e\u003c/code\u003e and also make sure you set \u003ccode\u003e\u0026#x3C;my-resource-group\u003e\u003c/code\u003e to your resource group name from earlier.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eaz appservice plan create --name \u0026#x3C;my-app-service-plan\u003e --resource-group \u0026#x3C;my-resource-group\u003e --sku FREE\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"create-the-app\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#create-the-app\"\u003e\u003ca href=\"#create-the-app\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eCreate the app\u003c/h3\u003e\n\u003cp\u003eNow we actually create the app, you have to give your app an \u003ccode\u003e\u0026#x3C;app-name\u003e\u003c/code\u003e and then make sure you paste in all the other options from things you've created previously.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eaz webapp create --name \u0026#x3C;app-name\u003e --resource-group \u0026#x3C;my-resource-group\u003e --plan \u0026#x3C;my-app-service-plan\u003e\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"configure-git-for-deployment\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#configure-git-for-deployment\"\u003e\u003ca href=\"#configure-git-for-deployment\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eConfigure git for deployment\u003c/h3\u003e\n\u003cp\u003eThis command sill set up you app to be deployed using git. The response you get from this command will be a git url you can use as the git remote to deploy.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eaz webapp deployment source config-local-git --name \u0026#x3C;app-name\u003e --resource-group \u0026#x3C;my-resource-group\u003e --query url --output tsv\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"configure-startup-script\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#configure-startup-script\"\u003e\u003ca href=\"#configure-startup-script\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eConfigure startup script\u003c/h3\u003e\n\u003cp\u003eIf you are coding in ES6 you probably have a build step. For that you may want to set up a custom deploy script. [Here is the documentation for how to do that](\u003ca href=\"https://github.com/projectkudu/kudu/wiki/Custom-Deployment-Script\" title=\"https://github.com/projectkudu/kudu/wiki/Custom-Deployment-Script\"\u003ehttps://github.com/projectkudu/kudu/wiki/Custom-Deployment-Script\u003c/a\u003e).\u003c/p\u003e\n\u003cp\u003eHowever I've noticed a bug here. Sometimes the order of commands in the deploy script appears to not be honored. According to [this github issue](\u003ca href=\"https://github.com/projectkudu/kudu/issues/2699\" title=\"https://github.com/projectkudu/kudu/issues/2699\"\u003ehttps://github.com/projectkudu/kudu/issues/2699\u003c/a\u003e), it may be related to the Always On setting in your app. But regardless the app tries to start up before the my deploy script is finished, which means it tries to run code that isnt built from webpacker yet.\u003c/p\u003e\n\u003cp\u003eSo, in an effort to find a quick fix I just committed my built files which sucks. I'm still trying to figure out a better workaround here because there hasn't been a lot of movement on that particular github issue.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"c:[\"$\",\"div\",null,{\"className\":\"sm:px-8 post mt-16 lg:mt-32\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative px-4 sm:px-8 lg:px-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl lg:max-w-5xl\",\"children\":[\"$\",\"div\",null,{\"className\":\"xl:relative\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl\",\"children\":[\"$\",\"article\",null,{\"children\":[[\"$\",\"header\",null,{\"className\":\"flex flex-col\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl font-bold font-bold tracking-tight sm:text-5xl\",\"children\":\"Deploying Node.js on Azure App Services\"}],[\"$\",\"div\",null,{\"className\":\"flex gap-3 pt-1\",\"children\":[[\"$\",\"time\",null,{\"dateTime\":\"2018-02-14\",\"className\":\"text-muted-foreground order-first flex items-center pr-2 text-base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500\"}],[\"$\",\"span\",null,{\"className\":\"ml-3\",\"children\":\"February 14, 2018\"}]]}],[\"$\",\"span\",null,{\"className\":\"text-muted-foreground\",\"children\":\"-\"}],[[\"$\",\"span\",\"node\",{\"className\":\"text-muted-foreground/80\",\"children\":\"node\"}],[\"$\",\"span\",\"azure\",{\"className\":\"text-muted-foreground/80\",\"children\":\"azure\"}],[\"$\",\"span\",\"production\",{\"className\":\"text-muted-foreground/80\",\"children\":\"production\"}]]]}],[\"$\",\"div\",null,{\"className\":\"text-accent-foreground pt-3 text-sm italic\",\"children\":[\"~\",\"4 min read\"]}]]}],[\"$\",\"div\",null,{\"className\":\"mt-8 prose dark:prose-invert\",\"data-mdx-content\":true,\"children\":[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$d\"}}]}]]}]}]}]}]}]}]}]\n"])</script><script>self.__next_f.push([1,"4:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Deploying Node.js on Azure App Services - Spencer Sharp\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"I’m Spencer, a software designer and entrepreneur based in New York City. I’m the founder and CEO of Planetaria, where we develop technologies that empower regular people to explore space on their own terms.\"}],[\"$\",\"link\",\"4\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"undefined/feed.xml\"}]]\n"])</script><script>self.__next_f.push([1,"b:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>