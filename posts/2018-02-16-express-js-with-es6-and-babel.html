<!DOCTYPE html><html lang="en" class="h-full antialiased"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" as="image" imageSrcSet="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=16&amp;q=75 16w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=32&amp;q=75 32w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=48&amp;q=75 48w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=64&amp;q=75 64w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=96&amp;q=75 96w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=128&amp;q=75 128w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=256&amp;q=75 256w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=384&amp;q=75 384w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=640&amp;q=75 640w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=750&amp;q=75 750w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=828&amp;q=75 828w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=3840&amp;q=75 3840w" imageSizes="2.25rem" fetchPriority="high"/><link rel="stylesheet" href="/_next/static/css/9d8f288a99c54fb3.css" crossorigin="" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-113544170b8b14d7.js" crossorigin=""/><script src="/_next/static/chunks/de8a8aed-ff24f23ca546a20c.js" async="" crossorigin=""></script><script src="/_next/static/chunks/362-edde6a9467fb7f3f.js" async="" crossorigin=""></script><script src="/_next/static/chunks/main-app-dca2b37e6b098eb8.js" async="" crossorigin=""></script><script src="/_next/static/chunks/736-93d26bf9f492bada.js" async=""></script><script src="/_next/static/chunks/545-972397648c423446.js" async=""></script><script src="/_next/static/chunks/871-e93f475163439fcd.js" async=""></script><script src="/_next/static/chunks/app/layout-58152a9375fe786b.js" async=""></script><script src="/_next/static/chunks/app/posts/page-6d06c0c42f2ef9eb.js" async=""></script><title>Express.js With ES6 and Babel - Spencer Sharp</title><meta name="description" content="I’m Spencer, a software designer and entrepreneur based in New York City. I’m the founder and CEO of Planetaria, where we develop technologies that empower regular people to explore space on their own terms."/><link rel="alternate" type="application/rss+xml" href="undefined/feed.xml"/><script src="/_next/static/chunks/polyfills-c67a75d1b6f99dc8.js" crossorigin="" noModule=""></script></head><body class="flex h-full"><script>!function(){try{var d=document.documentElement,c=d.classList;c.remove('light','dark');var e=localStorage.getItem('theme');if('system'===e||(!e&&true)){var t='(prefers-color-scheme: dark)',m=window.matchMedia(t);if(m.media!==t||m.matches){d.style.colorScheme = 'dark';c.add('dark')}else{d.style.colorScheme = 'light';c.add('light')}}else if(e){c.add(e|| '')}if(e==='light'||e==='dark')d.style.colorScheme=e}catch(e){}}()</script><div class="flex w-full"><div class="relative flex w-full flex-col"><header class="pointer-events-none relative z-50 flex flex-none flex-col" style="height:var(--header-height);margin-bottom:var(--header-mb)"><div class="top-0 z-10 h-16 pt-6" style="position:var(--header-position)"><div class="sm:px-8 top-[var(--header-top,theme(spacing.6))] w-full" style="position:var(--header-inner-position)"><div class="mx-auto w-full max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="relative flex gap-4"><div class="flex flex-1"><div class="h-10 w-10 rounded-full bg-white/90 p-0.5 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90 dark:ring-white/10"><a aria-label="Home" class="pointer-events-auto" href="/"><img alt="" fetchPriority="high" width="1000" height="1000" decoding="async" data-nimg="1" class="rounded-full bg-zinc-100 object-cover dark:bg-zinc-800 h-9 w-9" style="color:transparent" sizes="2.25rem" srcSet="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=16&amp;q=75 16w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=32&amp;q=75 32w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=48&amp;q=75 48w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=64&amp;q=75 64w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=96&amp;q=75 96w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=128&amp;q=75 128w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=256&amp;q=75 256w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=384&amp;q=75 384w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=640&amp;q=75 640w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=750&amp;q=75 750w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=828&amp;q=75 828w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1080&amp;q=75 1080w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1200&amp;q=75 1200w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=1920&amp;q=75 1920w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=2048&amp;q=75 2048w, /_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=3840&amp;q=75 3840w" src="/_next/image?url=%2F_next%2Fstatic%2Fmedia%2Favatar.6206df77.jpg&amp;w=3840&amp;q=75"/></a></div></div><div class="flex flex-1 justify-end md:justify-center"><nav class="pointer-events-auto hidden md:block"><ul class="flex rounded-full bg-white/90 px-3 text-sm font-medium text-zinc-800 shadow-lg shadow-zinc-800/5 ring-1 ring-zinc-900/5 backdrop-blur dark:bg-zinc-800/90 dark:text-zinc-200 dark:ring-white/10"><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/about">About</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/posts">Blog</a></li><li><a class="relative block px-3 py-2 transition hover:text-teal-500 dark:hover:text-teal-400" href="/projects">Projects</a></li></ul></nav></div><div class="flex justify-end md:flex-1"><div class="pointer-events-auto"><button class="inline-flex items-center justify-center text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 hover:bg-accent hover:text-accent-foreground rounded-md h-8 w-8 px-0" type="button" id="radix-:R75la:" aria-haspopup="menu" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="rotate-0 scale-100 transition-all dark:-rotate-90 dark:scale-0"><circle cx="12" cy="12" r="4"></circle><path d="M12 3v1"></path><path d="M12 20v1"></path><path d="M3 12h1"></path><path d="M20 12h1"></path><path d="m18.364 5.636-.707.707"></path><path d="m6.343 17.657-.707.707"></path><path d="m5.636 5.636.707.707"></path><path d="m17.657 17.657.707.707"></path></svg><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="absolute rotate-90 scale-0 transition-all dark:rotate-0 dark:scale-100"><path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path></svg><span class="sr-only">Toggle theme</span></button></div></div></div></div></div></div></div></div></header><main class="flex-auto"><div class="sm:px-8 post mt-16 lg:mt-32"><div class="mx-auto w-full max-w-7xl lg:px-8"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="xl:relative"><div class="mx-auto max-w-2xl"><article><header class="flex flex-col"><h1 class="text-4xl font-bold font-bold tracking-tight sm:text-5xl">Express.js With ES6 and Babel</h1><div class="flex gap-3 pt-1"><time dateTime="2018-02-16" class="text-muted-foreground order-first flex items-center pr-2 text-base"><span class="h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500"></span><span class="ml-3">February 16, 2018</span></time><span class="text-muted-foreground">-</span><span class="text-muted-foreground/80">express</span><span class="text-muted-foreground/80">node</span><span class="text-muted-foreground/80">babel</span><span class="text-muted-foreground/80">es6</span></div><div class="text-accent-foreground pt-3 text-sm italic">~<!-- -->4 min read</div></header><div class="mt-8 prose dark:prose-invert" data-mdx-content="true"><div><p>The <code>babel-cli</code> gives us a command line tool called <code>babel-node</code> that wraps around node and converts our ES6 code to basic javascript that node can read.</p>
<p><strong>However it is not recommended to use babel-node in production</strong></p>
<h3 id="new-express-app"><a aria-hidden="true" tabindex="-1" href="#new-express-app"><a href="#new-express-app" style="margin-right: 10px">#</a></a>New Express App</h3>
<p>First lets use the <a href="http://expressjs.com/en/starter/generator.html">express-generator</a> to make a new Express.js app.</p>
<pre><code>$ express --view pug --css sass new-app
$ cd new-app
$ npm install
</code></pre>
<p>This generates a new express app in a new folder called new-app. And as you can see, I've told express to use sass for css and pug for the html templating.</p>
<h3 id="rearrange-files"><a aria-hidden="true" tabindex="-1" href="#rearrange-files"><a href="#rearrange-files" style="margin-right: 10px">#</a></a>Rearrange Files</h3>
<p>We are going to need to rearrange things a bit. This is because of the production build. We want all the javascript files isolated in a subfolder of our app because later we are going to tell babel to compile all the files and things get really messy if all our code is in at the same level as our dot files, node_modules folder, etc...</p>
<p>So lets make a new folder called <code>app</code> and move all our express stuff into it.</p>
<pre><code>$ mkdir app
$ mv bin public routes views app.js app/
</code></pre>
<h3 id="install-babel"><a aria-hidden="true" tabindex="-1" href="#install-babel"><a href="#install-babel" style="margin-right: 10px">#</a></a>Install Babel</h3>
<p>First we need to add 2 babel packages to our apps dev-dependencies.</p>
<pre><code>$ npm install babel-cli --save-dev
$ npm install babel-preset-env --save-dev
</code></pre>
<p><a href="">babel-preset-env</a> by default behaves like <a href="">babel-preset-latest</a>. Basically it includes all the new features of ECMAScript that are standardized each year. But it also allows you to specify specific environments to build for such as specific browsers you want to support.</p>
<p>Next we need to add the babel configuration file <code>.babelrc</code> to our app folder. Make it look like this:</p>
<pre><code>{
  "presets": ["env"]
}
</code></pre>
<p>This just tells babel to use <a href="">babel-preset-env</a> that we just installed but take a look as some of the other configuration settings you can specify <a href="https://babeljs.io/docs/usage/babelrc/">here</a>.</p>
<h3 id="try-it-out"><a aria-hidden="true" tabindex="-1" href="#try-it-out"><a href="#try-it-out" style="margin-right: 10px">#</a></a>Try it Out</h3>
<p>To try it out lets open our <code>app.js</code> file and replace this line</p>
<pre><code>var express = require('express');
</code></pre>
<p>with this:</p>
<pre><code>import express from 'express';
</code></pre>
<p>And then we run express with babel with this command:</p>
<pre><code>$ babel-node app/bin/www
</code></pre>
<p>It works!</p>
<p>And you will notice that if you just run <code>node app/bin/www</code> you get an error which is expected.</p>
<p>Now lets add a npm script to make running this easier. Open up your <code>package.json</code> file and lets add a new line in the scripts section so it looks like this:</p>
<pre><code>...
  "scripts": {
    "start": "node ./bin/www",
    "start:dev": "babel-node ./app/bin/www"
  }
...
</code></pre>
<p>Now we can run our babelized app with the command:</p>
<pre><code>npm run start:dev
</code></pre>
<p>You might be asking, "Why don't we just use the existing start script". We need to save that for production because many production environments use the start script to run the app, but obviously we need to change it since we know <code>node ./bin/www</code> doesn't work.</p>
<h3 id="preparing-for-production"><a aria-hidden="true" tabindex="-1" href="#preparing-for-production"><a href="#preparing-for-production" style="margin-right: 10px">#</a></a>Preparing for Production</h3>
<p>So to prepare our app for production we need a build step that will take our ES6 code and generate node-friendly ES5 code in a file somewhere that node can run.</p>
<p>To do this I like to another npm script:</p>
<pre><code>...
  "scripts": {
    "start": "node ./bin/www",
    "start:dev": "babel-node ./app/bin/www",
    "build": "rm -rf ./build &#x26;&#x26; mkdir build &#x26;&#x26; babel --out-dir ./build --source-maps --copy-files ./app"
  }
...
</code></pre>
<p>As you can see this build script removes and recreates any existing <code>build</code> folder, and then runs the command <code>babel --out-dir ./build --source-maps --copy-files ./app</code> which compiles all the javascript files and copies any other files  into the <code>build</code> folder. Checkout <a href="https://babeljs.io/docs/usage/cli/">this page</a> for more info on how the babel command works.</p>
<p>You may want to add the <code>build</code> folder to your <code>.gitignore</code>.</p>
<p>Then the last thing to do is to change the start script to look like this:</p>
<pre><code>"start": "node ./app/bin/www"
</code></pre>
<p>And we are good to go.</p>
<p>Just make sure you run <code>npm run build</code> as part of any deployment into production.</p></div></div></article></div></div></div></div></div></div></main><footer class="mt-32 flex-none"><div class="sm:px-8"><div class="mx-auto w-full max-w-7xl lg:px-8"><div class="pb-16 pt-10"><div class="relative px-4 sm:px-8 lg:px-12"><div class="mx-auto max-w-2xl lg:max-w-5xl"><div class="flex flex-col items-center justify-between gap-6 sm:flex-row"><div class="flex flex-wrap justify-center gap-x-6 gap-y-1 text-sm font-medium text-zinc-800 dark:text-zinc-200"><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/about">About</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/projects">Projects</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/speaking">Speaking</a><a class="transition hover:text-teal-500 dark:hover:text-teal-400" href="/uses">Uses</a></div><p class="text-sm text-zinc-400 dark:text-zinc-500">© <!-- -->2023<!-- --> Spencer Sharp. All rights reserved.</p></div></div></div></div></div></div></footer></div></div><script src="/_next/static/chunks/webpack-113544170b8b14d7.js" crossorigin="" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/css/9d8f288a99c54fb3.css\",\"style\",{\"crossOrigin\":\"\"}]\n0:\"$L2\"\n"])</script><script>self.__next_f.push([1,"3:I[7483,[],\"\"]\n5:I[655,[],\"\"]\n6:I[2286,[\"736\",\"static/chunks/736-93d26bf9f492bada.js\",\"545\",\"static/chunks/545-972397648c423446.js\",\"871\",\"static/chunks/871-e93f475163439fcd.js\",\"185\",\"static/chunks/app/layout-58152a9375fe786b.js\"],\"ThemeProvider\"]\n7:I[7019,[\"736\",\"static/chunks/736-93d26bf9f492bada.js\",\"545\",\"static/chunks/545-972397648c423446.js\",\"871\",\"static/chunks/871-e93f475163439fcd.js\",\"185\",\"static/chunks/app/layout-58152a9375fe786b.js\"],\"Header\"]\n8:I[3849,[],\"\"]\n9:I[8656,[],\"\"]\na:I[4736,[\"736\",\"s"])</script><script>self.__next_f.push([1,"tatic/chunks/736-93d26bf9f492bada.js\",\"991\",\"static/chunks/app/posts/page-6d06c0c42f2ef9eb.js\"],\"\"]\n"])</script><script>self.__next_f.push([1,"2:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/9d8f288a99c54fb3.css\",\"precedence\":\"next\",\"crossOrigin\":\"\"}]],[\"$\",\"$L3\",null,{\"buildId\":\"ukvsT-xGIrbijjiNPJuDN\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/posts/2018-02-16-express-js-with-es6-and-babel\",\"initialTree\":[\"\",{\"children\":[\"posts\",{\"children\":[[\"slug\",\"2018-02-16-express-js-with-es6-and-babel\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"2018-02-16-express-js-with-es6-and-babel\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialHead\":[false,\"$L4\"],\"globalErrorComponent\":\"$5\",\"children\":[null,[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"h-full antialiased\",\"suppressHydrationWarning\":true,\"children\":[\"$\",\"body\",null,{\"className\":\"flex h-full\",\"children\":[\"$\",\"$L6\",null,{\"attribute\":\"class\",\"defaultTheme\":\"system\",\"enableSystem\":true,\"disableTransitionOnChange\":true,\"children\":[\"$\",\"div\",null,{\"className\":\"flex w-full\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative flex w-full flex-col\",\"children\":[[\"$\",\"$L7\",null,{}],[\"$\",\"main\",null,{\"className\":\"flex-auto\",\"children\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[\"$\",\"div\",null,{\"className\":\"sm:px-8 flex h-full items-center pt-16 sm:pt-32\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative px-4 sm:px-8 lg:px-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl lg:max-w-5xl\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center\",\"children\":[[\"$\",\"p\",null,{\"className\":\"text-base font-semibold text-zinc-400 dark:text-zinc-500\",\"children\":\"404\"}],[\"$\",\"h1\",null,{\"className\":\"mt-4 text-4xl font-bold tracking-tight text-zinc-800 dark:text-zinc-100 sm:text-5xl\",\"children\":\"Page not found\"}],[\"$\",\"p\",null,{\"className\":\"mt-4 text-base text-zinc-600 dark:text-zinc-400\",\"children\":\"Sorry, we couldn’t find the page you’re looking for.\"}],[\"$\",\"$La\",null,{\"href\":\"/\",\"children\":[\"$\",\"button\",null,{\"className\":\"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-10 px-4 py-2 mt-4\",\"children\":\"Go back home\"}]}]]}]}]}]}]}],\"notFoundStyles\":[],\"childProp\":{\"current\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",[\"slug\",\"2018-02-16-express-js-with-es6-and-babel\",\"d\"],\"children\"],\"loading\":\"$undefined\",\"loadingStyles\":\"$undefined\",\"loadingScripts\":\"$undefined\",\"hasLoading\":false,\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L9\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"childProp\":{\"current\":[\"$Lb\",\"$Lc\",null],\"segment\":\"__PAGE__?{\\\"slug\\\":\\\"2018-02-16-express-js-with-es6-and-babel\\\"}\"},\"styles\":null}],\"segment\":[\"slug\",\"2018-02-16-express-js-with-es6-and-babel\",\"d\"]},\"styles\":null}],\"segment\":\"posts\"},\"styles\":null}]}],[\"$\",\"footer\",null,{\"className\":\"mt-32 flex-none\",\"children\":[\"$\",\"div\",null,{\"className\":\"sm:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"pb-16 pt-10\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative px-4 sm:px-8 lg:px-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl lg:max-w-5xl\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex flex-col items-center justify-between gap-6 sm:flex-row\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex flex-wrap justify-center gap-x-6 gap-y-1 text-sm font-medium text-zinc-800 dark:text-zinc-200\",\"children\":[[\"$\",\"$La\",null,{\"href\":\"/about\",\"className\":\"transition hover:text-teal-500 dark:hover:text-teal-400\",\"children\":\"About\"}],[\"$\",\"$La\",null,{\"href\":\"/projects\",\"className\":\"transition hover:text-teal-500 dark:hover:text-teal-400\",\"children\":\"Projects\"}],[\"$\",\"$La\",null,{\"href\":\"/speaking\",\"className\":\"transition hover:text-teal-500 dark:hover:text-teal-400\",\"children\":\"Speaking\"}],[\"$\",\"$La\",null,{\"href\":\"/uses\",\"className\":\"transition hover:text-teal-500 dark:hover:text-teal-400\",\"children\":\"Uses\"}]]}],[\"$\",\"p\",null,{\"className\":\"text-sm text-zinc-400 dark:text-zinc-500\",\"children\":[\"© \",2023,\" Spencer Sharp. All rights reserved.\"]}]]}]}]}]}]}]}]}]]}]}]}]}]}],null]}]]\n"])</script><script>self.__next_f.push([1,"d:T14ac,"])</script><script>self.__next_f.push([1,"\u003cp\u003eThe \u003ccode\u003ebabel-cli\u003c/code\u003e gives us a command line tool called \u003ccode\u003ebabel-node\u003c/code\u003e that wraps around node and converts our ES6 code to basic javascript that node can read.\u003c/p\u003e\n\u003cp\u003e\u003cstrong\u003eHowever it is not recommended to use babel-node in production\u003c/strong\u003e\u003c/p\u003e\n\u003ch3 id=\"new-express-app\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#new-express-app\"\u003e\u003ca href=\"#new-express-app\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eNew Express App\u003c/h3\u003e\n\u003cp\u003eFirst lets use the \u003ca href=\"http://expressjs.com/en/starter/generator.html\"\u003eexpress-generator\u003c/a\u003e to make a new Express.js app.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ express --view pug --css sass new-app\n$ cd new-app\n$ npm install\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis generates a new express app in a new folder called new-app. And as you can see, I've told express to use sass for css and pug for the html templating.\u003c/p\u003e\n\u003ch3 id=\"rearrange-files\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#rearrange-files\"\u003e\u003ca href=\"#rearrange-files\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eRearrange Files\u003c/h3\u003e\n\u003cp\u003eWe are going to need to rearrange things a bit. This is because of the production build. We want all the javascript files isolated in a subfolder of our app because later we are going to tell babel to compile all the files and things get really messy if all our code is in at the same level as our dot files, node_modules folder, etc...\u003c/p\u003e\n\u003cp\u003eSo lets make a new folder called \u003ccode\u003eapp\u003c/code\u003e and move all our express stuff into it.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ mkdir app\n$ mv bin public routes views app.js app/\n\u003c/code\u003e\u003c/pre\u003e\n\u003ch3 id=\"install-babel\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#install-babel\"\u003e\u003ca href=\"#install-babel\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eInstall Babel\u003c/h3\u003e\n\u003cp\u003eFirst we need to add 2 babel packages to our apps dev-dependencies.\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ npm install babel-cli --save-dev\n$ npm install babel-preset-env --save-dev\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003e\u003ca href=\"\"\u003ebabel-preset-env\u003c/a\u003e by default behaves like \u003ca href=\"\"\u003ebabel-preset-latest\u003c/a\u003e. Basically it includes all the new features of ECMAScript that are standardized each year. But it also allows you to specify specific environments to build for such as specific browsers you want to support.\u003c/p\u003e\n\u003cp\u003eNext we need to add the babel configuration file \u003ccode\u003e.babelrc\u003c/code\u003e to our app folder. Make it look like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e{\n  \"presets\": [\"env\"]\n}\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis just tells babel to use \u003ca href=\"\"\u003ebabel-preset-env\u003c/a\u003e that we just installed but take a look as some of the other configuration settings you can specify \u003ca href=\"https://babeljs.io/docs/usage/babelrc/\"\u003ehere\u003c/a\u003e.\u003c/p\u003e\n\u003ch3 id=\"try-it-out\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#try-it-out\"\u003e\u003ca href=\"#try-it-out\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003eTry it Out\u003c/h3\u003e\n\u003cp\u003eTo try it out lets open our \u003ccode\u003eapp.js\u003c/code\u003e file and replace this line\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003evar express = require('express');\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ewith this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eimport express from 'express';\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd then we run express with babel with this command:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e$ babel-node app/bin/www\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eIt works!\u003c/p\u003e\n\u003cp\u003eAnd you will notice that if you just run \u003ccode\u003enode app/bin/www\u003c/code\u003e you get an error which is expected.\u003c/p\u003e\n\u003cp\u003eNow lets add a npm script to make running this easier. Open up your \u003ccode\u003epackage.json\u003c/code\u003e file and lets add a new line in the scripts section so it looks like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e...\n  \"scripts\": {\n    \"start\": \"node ./bin/www\",\n    \"start:dev\": \"babel-node ./app/bin/www\"\n  }\n...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eNow we can run our babelized app with the command:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003enpm run start:dev\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eYou might be asking, \"Why don't we just use the existing start script\". We need to save that for production because many production environments use the start script to run the app, but obviously we need to change it since we know \u003ccode\u003enode ./bin/www\u003c/code\u003e doesn't work.\u003c/p\u003e\n\u003ch3 id=\"preparing-for-production\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#preparing-for-production\"\u003e\u003ca href=\"#preparing-for-production\" style=\"margin-right: 10px\"\u003e#\u003c/a\u003e\u003c/a\u003ePreparing for Production\u003c/h3\u003e\n\u003cp\u003eSo to prepare our app for production we need a build step that will take our ES6 code and generate node-friendly ES5 code in a file somewhere that node can run.\u003c/p\u003e\n\u003cp\u003eTo do this I like to another npm script:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e...\n  \"scripts\": {\n    \"start\": \"node ./bin/www\",\n    \"start:dev\": \"babel-node ./app/bin/www\",\n    \"build\": \"rm -rf ./build \u0026#x26;\u0026#x26; mkdir build \u0026#x26;\u0026#x26; babel --out-dir ./build --source-maps --copy-files ./app\"\n  }\n...\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAs you can see this build script removes and recreates any existing \u003ccode\u003ebuild\u003c/code\u003e folder, and then runs the command \u003ccode\u003ebabel --out-dir ./build --source-maps --copy-files ./app\u003c/code\u003e which compiles all the javascript files and copies any other files  into the \u003ccode\u003ebuild\u003c/code\u003e folder. Checkout \u003ca href=\"https://babeljs.io/docs/usage/cli/\"\u003ethis page\u003c/a\u003e for more info on how the babel command works.\u003c/p\u003e\n\u003cp\u003eYou may want to add the \u003ccode\u003ebuild\u003c/code\u003e folder to your \u003ccode\u003e.gitignore\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThen the last thing to do is to change the start script to look like this:\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003e\"start\": \"node ./app/bin/www\"\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnd we are good to go.\u003c/p\u003e\n\u003cp\u003eJust make sure you run \u003ccode\u003enpm run build\u003c/code\u003e as part of any deployment into production.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"c:[\"$\",\"div\",null,{\"className\":\"sm:px-8 post mt-16 lg:mt-32\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto w-full max-w-7xl lg:px-8\",\"children\":[\"$\",\"div\",null,{\"className\":\"relative px-4 sm:px-8 lg:px-12\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl lg:max-w-5xl\",\"children\":[\"$\",\"div\",null,{\"className\":\"xl:relative\",\"children\":[\"$\",\"div\",null,{\"className\":\"mx-auto max-w-2xl\",\"children\":[\"$\",\"article\",null,{\"children\":[[\"$\",\"header\",null,{\"className\":\"flex flex-col\",\"children\":[[\"$\",\"h1\",null,{\"className\":\"text-4xl font-bold font-bold tracking-tight sm:text-5xl\",\"children\":\"Express.js With ES6 and Babel\"}],[\"$\",\"div\",null,{\"className\":\"flex gap-3 pt-1\",\"children\":[[\"$\",\"time\",null,{\"dateTime\":\"2018-02-16\",\"className\":\"text-muted-foreground order-first flex items-center pr-2 text-base\",\"children\":[[\"$\",\"span\",null,{\"className\":\"h-4 w-0.5 rounded-full bg-zinc-200 dark:bg-zinc-500\"}],[\"$\",\"span\",null,{\"className\":\"ml-3\",\"children\":\"February 16, 2018\"}]]}],[\"$\",\"span\",null,{\"className\":\"text-muted-foreground\",\"children\":\"-\"}],[[\"$\",\"span\",\"express\",{\"className\":\"text-muted-foreground/80\",\"children\":\"express\"}],[\"$\",\"span\",\"node\",{\"className\":\"text-muted-foreground/80\",\"children\":\"node\"}],[\"$\",\"span\",\"babel\",{\"className\":\"text-muted-foreground/80\",\"children\":\"babel\"}],[\"$\",\"span\",\"es6\",{\"className\":\"text-muted-foreground/80\",\"children\":\"es6\"}]]]}],[\"$\",\"div\",null,{\"className\":\"text-accent-foreground pt-3 text-sm italic\",\"children\":[\"~\",\"4 min read\"]}]]}],[\"$\",\"div\",null,{\"className\":\"mt-8 prose dark:prose-invert\",\"data-mdx-content\":true,\"children\":[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$d\"}}]}]]}]}]}]}]}]}]}]\n"])</script><script>self.__next_f.push([1,"4:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"Express.js With ES6 and Babel - Spencer Sharp\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"I’m Spencer, a software designer and entrepreneur based in New York City. I’m the founder and CEO of Planetaria, where we develop technologies that empower regular people to explore space on their own terms.\"}],[\"$\",\"link\",\"4\",{\"rel\":\"alternate\",\"type\":\"application/rss+xml\",\"href\":\"undefined/feed.xml\"}]]\n"])</script><script>self.__next_f.push([1,"b:null\n"])</script><script>self.__next_f.push([1,""])</script></body></html>